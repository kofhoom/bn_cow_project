<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="/_css/common.css">
    <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
</head>

<body>
    <div id="div-header"></div>
    <div class="wrap sign-up">
        <!-- 상세 타이틀 시작 -->
        <div class="common__info-title-wrap">
            <h1 class="common__info-title">
                마이페이지
            </h1>
        </div>
        <!-- 상세 타이틀 끝 -->
        <!-- 상세 페이지 맵 리스트 시작-->
        <div class="common__page-map-wrap">
            <ul>
                <li class="common__map-list">회원정보 수정</li>
                <li class="common__map-list">&middot;</li>
                <li class="common__map-list">내가 쓴 글 보기</li>
                <li class="common__map-list">&middot;</li>
                <li class="common__map-list">스크랩</li>
                <li class="common__map-list">&middot;</li>
                <li class="common__map-list">회원탈퇴</li>
            </ul>
        </div>
        <!-- 상세 페이지 맵 리스트 끝-->
        <!-- 상세 컨텐츠 시작 -->
        <section class="common__content mt40">
            <div class="form__wrap">
                <!-- 폼 영역 시작 -->
                <form class="common__form password_check" action="/subpage/member/private_join_check.php"
                    enctype="multipart/form-data" method="post" name="join_form" id="join_form"
                    onsubmit="return form_submit();">
                    <fieldset>
                        <div class="common__fieldset-inner">
                            <!-- 비밀번호 영역 시작-->
                            <div class="common-input__wrap">
                                <!-- 라벨 영역 시작 -->
                                <div class="common-box__label">
                                    <label>
                                        <span class="important__star">*</span>현재 비밀번호
                                    </label>
                                </div>
                                <!-- 라벨 영역 끝 -->
                                <!-- 인풋 영역 시작 -->
                                <div class="common-box__input">
                                    <div class="input__inner">
                                        <input type="password" id="password" name="password" autocomplete="new-password"
                                            oninput="passWordCheck(this.value)" />
                                        <!-- <span class="validation__message"></span> -->
                                    </div>
                                    <span class="input-error__message password"></span>
                                </div>
                                <!-- 인풋 영역 끝 -->
                            </div>
                            <!-- 비밀번호 영역 끝-->
                            <hr>

                            <!-- 비밀번호 영역 시작-->
                            <div class="common-input__wrap">
                                <!-- 라벨 영역 시작 -->
                                <div class="common-box__label">
                                    <label>
                                        <span class="important__star">*</span>새 비밀번호
                                    </label>
                                </div>
                                <!-- 라벨 영역 끝 -->
                                <!-- 인풋 영역 시작 -->
                                <div class="common-box__input">
                                    <div class="input__inner">
                                        <input type="password" id="password" name="password" autocomplete="new-password"
                                            oninput="passWordCheck(this.value)" />
                                        <!-- <span class="validation__message"></span> -->
                                    </div>
                                    <span class="input-error__message password">*특수문자, 숫자, 영문 모두 포함 8자리 이상</span>
                                </div>
                                <!-- 인풋 영역 끝 -->
                            </div>
                            <!-- 비밀번호 영역 끝-->
                            <!-- 비밀번호 확인 영역 시작-->
                            <div class="common-input__wrap">
                                <!-- 라벨 영역 시작 -->
                                <div class="common-box__label">
                                    <label>
                                        <span class="important__star">*</span>비밀번호 확인
                                    </label>
                                </div>
                                <!-- 라벨 영역 끝 -->
                                <!-- 인풋 영역 시작 -->
                                <div class="common-box__input">
                                    <div class="input__inner">
                                        <input type="password" id="password_check" name="password_check"
                                            autocomplete="new-password"
                                            onkeyup="passWordRecheck(this.value,'password',1)" />
                                        <!-- <span class="validation__message"></span> -->
                                    </div>
                                    <span class="input-error__message password_check"></span>
                                </div>
                                <!-- 인풋 영역 끝 -->
                            </div>
                            <!-- 비밀번호 확인 영역 끝-->
                            <hr>
                            <!-- 비밀번호 찾기 질문 영역 시작-->
                            <div class="common-input__wrap">
                                <div class="common-box__label">
                                    <!-- 라벨 영역 시작 -->
                                    <label>
                                        <span class="important__star">*</span>비밀번호 찾기 질문
                                    </label>
                                    <!-- 라벨 영역 끝 -->
                                </div>
                                <!-- 인풋 영역 시작 -->
                                <div class="common-box__input">
                                    <div class="input__inner">
                                        <select name="password_answer_check" id="password_answer_check">
                                            <option value="d">질문선택</option>
                                            <option value="test">테스트</option>
                                        </select>
                                    </div>
                                    <span class="input-error__message password_answer_check"></span>
                                </div>
                                <!-- 인풋 영역 끝 -->
                            </div>
                            <!-- 비밀번호 찾기 답 영역 시작-->
                            <div class="common-input__wrap">
                                <div class="common-box__label">
                                    <!-- 라벨 영역 시작 -->
                                    <label>
                                        <span class="important__star">*</span>비밀번호 찾기 답
                                    </label>
                                    <!-- 라벨 영역 끝 -->
                                </div>
                                <!-- 인풋 영역 시작 -->
                                <div class="common-box__input">
                                    <div class="input__inner">
                                        <input type="text" id="password_answer_check_result"
                                            name="password_answer_check_result" />
                                    </div>
                                    <span class="input-error__message password_answer_check_result"></span>
                                </div>
                                <!-- 인풋 영역 끝 -->
                            </div>
                            <!-- 비밀번호 찾기 답 영역 끝-->
                            <!-- 가입신청 버튼 시작 -->
                            <div class="common__edit-list survey">
                                <input type="submit" class="submit__btn" value="수정" />
                            </div>
                            <!-- 가입신청 버튼 끝 -->
                        </div>
                    </fieldset>




                </form>
                <!-- 폼 영역 끝 -->
            </div>
        </section>
        <!-- 상세 컨텐츠 끝 -->
    </div>

    <div id="div-footer"></div>

    <script defer>
        async function load() {
            let jsComponent = await import("/_js/fetch.js");
            jsComponent.headerLayout();
            jsComponent.footerLayout();
        }
        load();
    </script>
    <script>
        /*******************************************************************
    // 설명 : 전역 변수
    ********************************************************************/
        let passwordState = false; //일반 비밀번호 유효성
        let passwordCheck = false; //일반 비밀번호 일치 확인

        /*******************************************************************
        // 설명 : 공통정의 함수
        ********************************************************************/

        /**
         * 비밀번호 유효성 오류 텍스트
         * @param {DomClass} targetClass
         * @param {String} message 에러 메시지
         */

        const errorText = (targetClass, message) =>
            (document.querySelector(`.${targetClass}`).innerHTML = message);

        /**
         * 성별 선택 유효성
         * @param {name} rName radio name
         * @returns radio에 체크벨류값
         */

        const radioCheck = (rName) => {
            let radioArr = '';
            radioArr = document.getElementsByName(rName);
            console.log(radioArr)
            for (i = 0; i < radioArr.length; i++) {
                if (radioArr[i].checked) {
                    radioValue = radioArr[i].value;

                    return radioValue;
                }
            }
        };

        /**
         * 인풋 벨류 초기화 함수
         * @param {String} errorTextDomName valueReset로 부터 전달받은 메개변수
         */
        const eventBindValue = (errorTextDomName) => {
            const elTargets = document.querySelector(`.${errorTextDomName}`)
            if (event.target.value.length > 0) {
                elTargets.innerHTML = "";
                return
            }
            elTargets.innerHTML = "";
        }

        /**
         * 벨류 초기화 공통 함수
         * @param {String} targetName 초기화될 해당 에러 문구 이름
         */
        const valueReset = (targetName, radioTarget) => {
            inputs = document.getElementById(targetName) || document.getElementsByName(targetName)[0];
            switch (inputs.type) {
                case 'text':
                    inputs.setAttribute("onkeyup", "eventBindValue('" + targetName + "')");
                    break;
                case 'radio':
                    let radioArrays = document.querySelectorAll(`.${radioTarget}`);
                    for (i = 0; i < radioArrays.length; i++) {
                        radioArrays[i].addEventListener("click", () => {
                            if (event.target.value == "on") {
                                eventBindValue(targetName)
                            }
                        });
                    }
                    break;
                case 'select-one':
                    inputs.addEventListener('change', () => {
                        if (event.target.value !== 'd') {
                            eventBindValue(targetName)
                        }
                    })
            }
        };

        /**
         * 종합 문자열 유효성 체크
         * @param {String} str input에 value
         * @param {String} type 해당 문자의 타입
         * @returns {Boolean}
         */
        const strCheck = (str, type) => {
            let REGEX = {
                EMAIL: /^[0-9a-zA-Z]([-_\.]?[0-9a-zA-Z])*@[0-9a-zA-Z]([-_\.]?[0-9a-zA-Z])*\.[a-zA-Z]{2,3}$/i,
                ID_RULE: /^[a-z0-9_-]{5,15}$/,
                PWD_RULE: /^(?=.*[a-zA-Z])((?=.*\d)(?=.*\W)).{8,16}$/,
                NAME_RULE: /^[가-힣a-zA-Z]+$/,
            };

            if (type === "email") return REGEX.EMAIL.test(str);
            else if (type === "id") return REGEX.ID_RULE.test(str);
            else if (type === "pwd") return REGEX.PWD_RULE.test(str);
            else if (type === "name") return REGEX.NAME_RULE.test(str);
            else return false;
        }

        // 폼 submit 함수
        function form_submit() {
            let form = document.join_form;
            let flag = true; // submit 기능 활성화 or 비활성화 상태 설정

            event.preventDefault();

            // 아이디
            if (!form.member_id.value) {
                alert("아이디를 입력해주세요.");
                errorText("member_id", "아이디를 입력해주세요.");
                form.member_id.focus();
                valueReset("member_id");

                return false;
            }

            // 비밀번호
            if (!form.password.value) {
                alert("비밀번호를 입력해주세요.");
                errorText("password", "비밀번호를 입력해주세요.");
                form.password.focus();

                return false;
            }

            // 비밀번호 확인
            if (!form.password_check.value) {
                alert("비밀번호 확인을 입력해주세요.");
                errorText("password_check", "비밀번호 확인을 입력해주세요.");
                form.password_check.focus();

                return false;
            }
            // 비밀번호 찾기 질문
            if (form.password_answer_check.value == 'd') {
                alert("비밀번호 찾기 질문을 선택해주세요.");
                errorText("password_answer_check", "비밀번호 찾기 질문을 선택해주세요");
                form.password_answer_check.focus();
                valueReset("password_answer_check");

                return false;
            }
            // 비밀번호 찾기 답
            if (!form.password_answer_check_result.value) {
                alert("비밀번호 찾기 답을 입력해 주세요");
                errorText("password_answer_check_result", "비밀번호 찾기 답을 입력해 주세요");
                form.password_answer_check_result.focus();
                valueReset("password_answer_check_result");

                return false;
            }

            // 이름
            if (!form.user_name.value) {
                alert("이름을 입력해주세요.");
                errorText("user_name", "이름을 입력해주세요.");
                form.user_name.focus();
                valueReset("user_name");

                return false;
            }
            // 생년월일
            if (!form.user_date.value) {
                alert("생년월일을 입력해주세요.");
                errorText("user_date", "생년월일을 입력해주세요.");
                form.user_date.focus();
                valueReset("user_date");

                return false;
            }
            // 성별
            if (radioCheck("gender_check") == undefined) {
                alert("성별을 선택 해주세요.");
                errorText("gender_check", "성별을 선택 해주세요.");
                form.gender_check[0].focus();
                valueReset("gender_check", "gender-check__radio");

                return false;
            }

            // 수의사면허번호
            if (!form.license_number.value) {
                alert("수의사면허번호를 입력해주세요.");
                errorText("license_number", "수의사면허번호를 입력해주세요.");
                form.license_number.focus();
                valueReset("license_number");

                return false;
            }

            // 휴대전화번호
            if (!form.insert_tel.value) {
                alert("휴대전화번호를 입력해주세요.");
                errorText("insert_tel", "휴대전화번호를 입력해주세요.");
                form.insert_tel.focus();
                valueReset("insert_tel");

                return false;
            }
            // 이메일
            if (!form.email1.value) {
                alert("이메일을 입력해주세요.");
                form.email1.focus();
                errorText("email1", "이메일을 입력 해주세요.");
                valueReset("email1");

                return false;
            }

            // 이메일 상세
            if (!form.email2.value) {
                alert("이메일 상세를 입력해주세요.");
                form.email2.focus();
                errorText("email2", "이메일 상세를 입력 해주세요.");
                valueReset("email2");

                return false;
            }

            // 예금주
            if (!form.account_holder.value) {
                alert("예금주를 입력해주세요.");
                errorText("account_holder", "예금주를 입력해주세요.");
                form.account_holder.focus();
                valueReset("account_holder");

                return false;
            }
            // 은행명
            if (!form.bank_account_name.value) {
                alert("은행명을 입력해주세요.");
                errorText("bank_account_name", "은행명을 입력해주세요.");
                form.bank_account_name.focus();
                valueReset("bank_account_name");

                return false;
            }
            // 계좌번호
            if (!form.bank_account_number.value) {
                alert("계좌번호를 입력해주세요.");
                errorText("bank_account_number", "계좌번호를 입력해주세요.");
                form.bank_account_number.focus();
                valueReset("bank_account_number");

                return false;
            }
            // 기관명(병원명)
            if (!form.hospital_name.value) {
                alert("기관명을 입력해주세요.");
                errorText("hospital_name", "기관명을 입력해주세요.");
                form.hospital_name.focus();
                valueReset("hospital_name");

                return false;
            }

            // 우편번호
            if (!form.zipcode.value) {
                alert("우편번호를 입력 해주세요.");
                errorText("zipcode", "우편번호를 입력 해주세요.");
                form.zipcode.focus();
                valueReset("zipcode");

                return false;
            }

            // 주소
            if (!form.address1.value) {
                alert("주소를 입력 해주세요.");
                errorText("address1", "주소를 입력 해주세요.");
                form.address1.focus();
                valueReset("address1");

                return false;
            }

            // 상세주소
            if (!form.address2.value) {
                alert("상세주소를 입력 해주세요.");
                errorText("address2", "상세주소를 입력 해주세요.");
                form.address2.focus();
                valueReset("address2");

                return false;
            }
            // 직책명
            if (!form.position_name.value) {
                alert("직책명을 입력해주세요.");
                errorText("position_name", "직책명을 입력해주세요.");
                form.position_name.focus();
                valueReset("position_name");

                return false;
            }
            // 진료 축종
            if (radioCheck("animal_check") == undefined) {
                alert("진료 축종을 선택 해주세요.");
                errorText("animal_check", "진료 축종을 선택 해주세요.");
                form.animal_check[0].focus();
                valueReset("animal_check", 'animal-check__radio');

                return false;
            }

            // 이용약관 동의
            if (form.check1.checked == false) {
                alert("이용약관 동의에 체크해주세요.");
                form.check1.focus();

                return false;
            }
            // 개인정보 수집 및 이용 동의
            if (form.check2.checked == false) {
                alert("개인정보 수집 및 이용 동의에 체크해주세요.");
                form.check2.focus();

                return false;
            }

            // 비밀번호 유효성 여부
            if (!passwordState) {
                alert("비밀번호 유효성을 확인해주세요.");
                errorText("password", "비밀번호 유효성을 확인해주세요.");
                form.password.focus();


                return false;
            }
            // 비밀번호 일치 여부
            if (!passwordCheck) {
                alert("비밀번호가 일치하지 않습니다.");
                errorText("password_check", "비밀번호가 일치하지 않습니다");
                form.password_check.focus();

                return false;
            }
            if (flag == true) {
                console.log(
                    "회원가입이 완료되었습니다.\n" +
                    `아이디: ${form.member_id.value}\n
          비밀번호: ${form.password.value}\n
          비밀번호확인: ${form.password_check.value}\n
          비밀번호찾기질문: ${form.password_answer_check.value}\n
          비밀번호찾기답: ${form.password_answer_check_result.value}\n
          이름: ${form.user_name.value}\n
          생년월일: ${form.user_date.value}\n
          성별: ${form.gender_check.value}\n
          수의사면허번호: ${form.license_number.value}\n
          휴대전화번호: ${form.insert_tel.value}\n
          이메일: ${form.email1.value}\n
          이메일 상세: ${form.email2.value}\n
          예금주: ${form.account_holder.value}\n
          은행명: ${form.bank_account_name.value}\n
          계좌번호: ${form.bank_account_number.value}\n
          기관명(병원명): ${form.hospital_name.value}\n
          우편번호: ${form.zipcode.value}\n
          주소: ${form.address1.value}\n
          상세주소: ${form.address2.value}\n
          직책명: ${form.position_name.value}\n
          진료 축종: ${form.animal_check.value}\n
          이용약관동의: ${form.check1.checked}\n
          개인정보 수집 및 이용 동의: ${form.check2.checked}\n
          `
                );

                form.submit();

            }
        }

        // 비밀번호 유효성
        function passWordCheck(values) {
            let passWordErrorText = document.querySelector(".input-error__message.password");
            let passVal = values;

            if (values.length > 0)
                passWordErrorText.innerHTML = "";

            if (!passVal) {
                passWordErrorText.innerHTML = "*특수문자, 숫자, 영문자 포함 8자리 이상";
                passWordErrorText.style.color = "gray";

                return (passwordState = false);
            } else {
                if (!strCheck(passVal, "pwd")) {
                    passWordErrorText.innerHTML = "*특수문자, 숫자, 영문자 포함 8자리 이상";
                    passWordErrorText.style.color = "red";

                    return (passwordState = false);
                } else {
                    passWordErrorText.innerHTML = "사용가능한 비밀번호입니다.";
                    passWordErrorText.style.color = "blue";

                    return (passwordState = true);
                }
            }
        }

        // 비밀번호 확인
        function passWordRecheck(values, targetId, idx) {
            const mainPassWord = document.getElementById(`${targetId}`).value;
            const passWordErrorText = document.querySelector(".input-error__message.password_check");

            if (values.length > 0) {
                passWordErrorText.innerHTML = "";
            }

            if (!values) passWordErrorText.innerHTML = "";
            else if (values == mainPassWord) {
                passWordErrorText.classList.remove("error");
                passWordErrorText.innerHTML = "비밀번호가 일치합니다.";
                passWordErrorText.style.color = "blue";

                return (passwordCheck = true);
            } else {
                passWordErrorText.classList.add("error");
                passWordErrorText.innerHTML = "비밀번호가 일치하지 않습니다.";
                passWordErrorText.style.color = "red";

                return (passwordCheck = false);
            }
        }

        // 이메일 입력선택
        function emailTypeSelect() {
            let form = document.join_form;

            if (form.user_email3.value == "w") {
                form.email2.readOnly = false;
                form.email2.value = "";
                form.email2.focus();
            } else if (form.user_email3.value == "b") {
                form.email2.readOnly = true;
                form.email2.value = "";
            } else {
                form.email2.readOnly = true;
                form.email2.value = form.user_email3.value;
            }
        }


        const toggleAgree = document.querySelectorAll('.common__form-content');
        toggleAgree.forEach(el => {
            el.addEventListener('click', () => {
                el.classList.toggle('active')
            })
        })
    </script>
</body>

</html>